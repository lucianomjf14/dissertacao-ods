<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Dashboard ODS - M√©tricas Completas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .metrics-section {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 30px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .metric-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .ods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 30px;
        }

        .ods-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .ods-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            border-color: #3498db;
        }

        .ods-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            border-radius: 8px;
            object-fit: contain;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
        }

        .ods-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .ods-count {
            font-size: 1.8rem;
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 5px;
        }

        .ods-percentage {
            font-size: 0.8rem;
            color: #7f8c8d;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .details-panel {
            position: fixed;
            top: 0;
            right: -500px;
            width: 500px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.2);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }

        .details-panel.active {
            right: 0;
        }

        .details-header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
        }

        .details-content {
            padding: 20px;
        }

        .study-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Dashboard ODS - An√°lise Completa</h1>
            <p>Visualiza√ß√£o de m√©tricas dos Objetivos de Desenvolvimento Sustent√°vel</p>
            <p><strong>41 estudos analisados</strong> ‚Ä¢ Dados corrigidos e validados</p>
        </div>

        <div class="metrics-section">
            <h2 style="text-align: center; margin-bottom: 20px;">üìä M√©tricas Gerais</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-title">Total de Estudos</div>
                    <div class="metric-value">41</div>
                    <div>Corpus completo analisado</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">ODS mais Frequente</div>
                    <div class="metric-value">ODS 11</div>
                    <div>22 estudos (53.7%)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">Estudos "Geral"</div>
                    <div class="metric-value">17</div>
                    <div>41.5% do total</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">ODS Identificados</div>
                    <div class="metric-value">15</div>
                    <div>de 17 ODS (88.2%)</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="showAllStudies()">
                üìã Ver Todos os Estudos
            </button>
            <button class="btn btn-primary" onclick="showStatistics()">
                üìà Estat√≠sticas Detalhadas
            </button>
            <span style="margin-left: auto; color: #7f8c8d;">
                Clique em um ODS para ver os estudos relacionados
            </span>
        </div>

        <div class="ods-grid" id="odsGrid">
            <!-- Os cart√µes dos ODS ser√£o inseridos aqui pelo JavaScript -->
        </div>

        <div class="footer">
            <p><strong>Laborat√≥rio de Cidades Sustent√°veis e Inteligentes</strong></p>
            <div style="font-size: 0.75rem; color: #bdc3c7; margin-top: 10px;">
                UNESA ‚Ä¢ Mestrado em Administra√ß√£o ‚Ä¢ 2025
            </div>
        </div>
    </div>

    <!-- Painel de detalhes -->
    <div class="details-panel" id="detailsPanel">
        <div class="details-header">
            <button class="close-btn" onclick="closeDetails()">&times;</button>
            <h3 id="detailsTitle">Detalhes</h3>
            <p id="detailsSubtitle"></p>
        </div>
        <div class="details-content" id="detailsContent">
            <!-- Conte√∫do ser√° inserido pelo JavaScript -->
        </div>
    </div>

    <script src="dados_javascript.js"></script>
    <script>
        // Mapeamento de ODS para √≠cones
        const odsIcons = {
            'ODS 1': '√çcones oficiais - ODS/SDG-icon-PT--01-2-01.png',
            'ODS 2': '√çcones oficiais - ODS/SDG-icon-PT--02-2.png',
            'ODS 3': '√çcones oficiais - ODS/SDG-icon-PT--03-2.png',
            'ODS 4': '√çcones oficiais - ODS/SDG-icon-PT--04-2-01.png',
            'ODS 5': '√çcones oficiais - ODS/SDG-icon-PT--05-2.png',
            'ODS 6': '√çcones oficiais - ODS/SDG-icon-PT--06-2-01.png',
            'ODS 7': '√çcones oficiais - ODS/SDG-icon-PT--07-2-01.png',
            'ODS 8': '√çcones oficiais - ODS/SDG-icon-PT--08-2-01.png',
            'ODS 9': '√çcones oficiais - ODS/SDG-icon-PT--09-2.png',
            'ODS 10': '√çcones oficiais - ODS/SDG-icon-PT--10-2.png',
            'ODS 11': '√çcones oficiais - ODS/SDG-icon-PT--11-2.png',
            'ODS 12': '√çcones oficiais - ODS/SDG-icon-PT--12-2-01.png',
            'ODS 13': '√çcones oficiais - ODS/SDG-icon-PT--13-2.png',
            'ODS 14': '√çcones oficiais - ODS/SDG-icon-PT--14-2-01.png',
            'ODS 15': '√çcones oficiais - ODS/SDG-icon-PT--15-2-01.png',
            'ODS 16': '√çcones oficiais - ODS/SDG-icon-PT--16-2.png',
            'ODS 17': '√çcones oficiais - ODS/SDG-icon-PT--17-2.png',
            'Geral': 'logo-sepado.png'
        };

        // Calcular m√©tricas dos ODS
        const odsMetrics = {};
        const odsKeys = ['ODS 1', 'ODS 2', 'ODS 3', 'ODS 4', 'ODS 5', 'ODS 6', 'ODS 7', 'ODS 8', 'ODS 9', 'ODS 10', 'ODS 11', 'ODS 12', 'ODS 13', 'ODS 14', 'ODS 15', 'ODS 16', 'ODS 17', 'Geral'];

        odsKeys.forEach(ods => {
            const count = data.filter(item => item[ods] === 'x').length;
            const percentage = data.length > 0 ? (count / data.length * 100).toFixed(1) : 0;
            odsMetrics[ods] = { count, percentage };
        });

        // Gerar cart√µes dos ODS
        function generateOdsCards() {
            const grid = document.getElementById('odsGrid');
            grid.innerHTML = '';

            odsKeys.forEach(ods => {
                const metrics = odsMetrics[ods];
                const iconPath = odsIcons[ods];
                
                const card = document.createElement('div');
                card.className = 'ods-card';
                card.onclick = () => showOdsDetails(ods);
                
                card.innerHTML = `
                    <img src="${iconPath}" alt="${ods}" class="ods-icon" onerror="this.style.display='none'">
                    <div class="ods-title">${ods}</div>
                    <div class="ods-count">${metrics.count}</div>
                    <div class="ods-percentage">${metrics.percentage}%</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Mostrar detalhes de um ODS
        function showOdsDetails(ods) {
            const relatedStudies = data.filter(item => item[ods] === 'x');
            const metrics = odsMetrics[ods];
            
            document.getElementById('detailsTitle').textContent = ods;
            document.getElementById('detailsSubtitle').textContent = 
                `${metrics.count} estudos (${metrics.percentage}% do total)`;
            
            const content = document.getElementById('detailsContent');
            
            if (relatedStudies.length === 0) {
                content.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 40px;">Nenhum estudo encontrado para este ODS.</p>';
            } else {
                content.innerHTML = relatedStudies.map(study => `
                    <div class="study-card">
                        <h4 style="color: #2c3e50; margin-bottom: 10px;">
                            ${study.Autores} (${study.Ano})
                        </h4>
                        <p style="font-weight: 600; margin-bottom: 8px;">
                            ${study.T√≠tulo}
                        </p>
                        <p style="color: #7f8c8d; font-size: 0.9rem; margin-bottom: 8px;">
                            ${study.Peri√≥dico} ‚Ä¢ ${study.Categorias}
                        </p>
                        <p style="font-size: 0.85rem; color: #5a6c7d;">
                            <strong>Aspecto Principal:</strong> ${study['Aspecto Principal - Estudo']}
                        </p>
                    </div>
                `).join('');
            }
            
            document.getElementById('detailsPanel').classList.add('active');
        }

        // Fechar painel de detalhes
        function closeDetails() {
            document.getElementById('detailsPanel').classList.remove('active');
        }

        // Mostrar todos os estudos
        function showAllStudies() {
            document.getElementById('detailsTitle').textContent = 'Todos os Estudos';
            document.getElementById('detailsSubtitle').textContent = `${data.length} estudos no total`;
            
            const content = document.getElementById('detailsContent');
            content.innerHTML = data.map(study => `
                <div class="study-card">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">
                        [${study.ID}] ${study.Autores} (${study.Ano})
                    </h4>
                    <p style="font-weight: 600; margin-bottom: 8px;">
                        ${study.T√≠tulo}
                    </p>
                    <p style="color: #7f8c8d; font-size: 0.9rem; margin-bottom: 8px;">
                        ${study.Peri√≥dico} ‚Ä¢ ${study.Categorias}
                    </p>
                    <p style="font-size: 0.85rem; color: #5a6c7d;">
                        <strong>ODS:</strong> ${study['ODS (Geral / Espec√≠fico)']}
                    </p>
                </div>
            `).join('');
            
            document.getElementById('detailsPanel').classList.add('active');
        }

        // Mostrar estat√≠sticas detalhadas
        function showStatistics() {
            document.getElementById('detailsTitle').textContent = 'Estat√≠sticas Detalhadas';
            document.getElementById('detailsSubtitle').textContent = 'An√°lise completa dos dados';
            
            const totalWithOds = odsKeys.slice(0, 17).reduce((sum, ods) => sum + odsMetrics[ods].count, 0);
            const avgPerOds = (totalWithOds / 17).toFixed(1);
            
            const sortedOds = odsKeys.slice(0, 17).sort((a, b) => odsMetrics[b].count - odsMetrics[a].count);
            
            const content = document.getElementById('detailsContent');
            content.innerHTML = `
                <div style="margin-bottom: 30px;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">üìà Resumo Estat√≠stico</h4>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <p><strong>Total de estudos:</strong> ${data.length}</p>
                        <p><strong>Estudos com ODS espec√≠ficos:</strong> ${totalWithOds}</p>
                        <p><strong>Estudos gerais:</strong> ${odsMetrics['Geral'].count}</p>
                        <p><strong>M√©dia por ODS:</strong> ${avgPerOds} estudos</p>
                        <p><strong>ODS mais abordados:</strong> ${sortedOds.slice(0, 3).map(ods => `${ods} (${odsMetrics[ods].count})`).join(', ')}</p>
                    </div>
                </div>
                
                <h4 style="color: #2c3e50; margin-bottom: 15px;">üèÜ Ranking dos ODS</h4>
                ${sortedOds.map((ods, index) => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; margin-bottom: 8px; background: ${index < 3 ? '#e8f5e8' : '#f8f9fa'}; border-radius: 6px;">
                        <span><strong>${index + 1}¬∫</strong> ${ods}</span>
                        <span><strong>${odsMetrics[ods].count}</strong> estudos (${odsMetrics[ods].percentage}%)</span>
                    </div>
                `).join('')}
            `;
            
            document.getElementById('detailsPanel').classList.add('active');
        }

        // Inicializar a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            generateOdsCards();
            console.log('‚úÖ Dashboard carregado com', data.length, 'estudos');
            console.log('üìä M√©tricas dos ODS:', odsMetrics);
        });

        // Fechar painel ao clicar fora
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('detailsPanel');
            if (panel.classList.contains('active') && !panel.contains(e.target) && !e.target.closest('.ods-card') && !e.target.closest('.btn')) {
                closeDetails();
            }
        });
    </script>
</body>
</html>
